import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns


# These are the differences z_true - z_single_host for the original M1 and M6 EMRI catalogs
# choosing only the nearest host in redshift (min(e.z_true - z_gal) for z_gal in e.galaxies)
# We plot z_single_host - ztrue, so we change the sign to all the items in the list

M1_loudest_30  = [-0.00010999999999999899, 3.0000000000085514e-05, -0.0001000000000000445, -0.0025800000000000267, -0.0008199999999999319, -0.00025999999999998247, -0.000130000000000019, 0.0025800000000000267, 3.0000000000030003e-05, 0.000200000000000089, -5.999999999994898e-05, 0.0009100000000000219, -0.004060000000000008, -0.00030999999999997696, 0.0015399999999999858, -0.000260000000000038, -0.0041100000000000025, -0.0008799999999999919, -6.0000000000004494e-05, 0.0016500000000000403, 0.0006000000000000449, 0.003919999999999979, -0.00029000000000001247, -4.000000000001225e-05, -0.0005700000000000149, -0.003190000000000026, 0.00014000000000000123, -0.0011899999999999966, -1.0000000000010001e-05, 0.0004299999999999998]
M1_loudest_40  = [4.999999999999449e-05, -3.0000000000030003e-05, 0.00013999999999997348, -0.000130000000000019, 2.0000000000020002e-05, -0.00024000000000001798, -4.0000000000040004e-05, -0.0007099999999999884, 5.999999999994898e-05, 0.0007200000000000262, -0.00010999999999999899, 3.0000000000085514e-05, -0.0001000000000000445, -0.0025800000000000267, -0.0008199999999999319, -0.00025999999999998247, -0.000130000000000019, 0.0025800000000000267, 3.0000000000030003e-05, 0.000200000000000089, -5.999999999994898e-05, 0.0009100000000000219, -0.004060000000000008, -0.00030999999999997696, 0.0015399999999999858, -0.000260000000000038, -0.0041100000000000025, -0.0008799999999999919, -6.0000000000004494e-05, 0.0016500000000000403, 0.0006000000000000449, 0.003919999999999979, -0.00029000000000001247, -4.000000000001225e-05, -0.0005700000000000149, -0.003190000000000026, 0.00014000000000000123, -0.0011899999999999966, -1.0000000000010001e-05, 0.0004299999999999998]
M1_loudest_50  = [-3.0000000000002247e-05, 0.0006500000000000117, 0.0004699999999999982, 2.999999999997449e-05, -7.00000000000145e-05, -0.0018799999999999928, -0.0010399999999999854, -0.007440000000000002, -2.0000000000020002e-05, -4.999999999999449e-05, 4.999999999999449e-05, -3.0000000000030003e-05, 0.00013999999999997348, -0.000130000000000019, 2.0000000000020002e-05, -0.00024000000000001798, -4.0000000000040004e-05, -0.0007099999999999884, 5.999999999994898e-05, 0.0007200000000000262, -0.00010999999999999899, 3.0000000000085514e-05, -0.0001000000000000445, -0.0025800000000000267, -0.0008199999999999319, -0.00025999999999998247, -0.000130000000000019, 0.0025800000000000267, 3.0000000000030003e-05, 0.000200000000000089, -5.999999999994898e-05, 0.0009100000000000219, -0.004060000000000008, -0.00030999999999997696, 0.0015399999999999858, -0.000260000000000038, -0.0041100000000000025, -0.0008799999999999919, -6.0000000000004494e-05, 0.0016500000000000403, 0.0006000000000000449, 0.003919999999999979, -0.00029000000000001247, -4.000000000001225e-05, -0.0005700000000000149, -0.003190000000000026, 0.00014000000000000123, -0.0011899999999999966, -1.0000000000010001e-05, 0.0004299999999999998]
M1_faintest_30 = [-3.999999999998449e-05, 8.999999999997899e-05, 0.004690000000000083, 0.00015999999999999348, -2.0000000000020002e-05, 0.0, 0.0007500000000000284, 0.0, -0.00020000000000003348, 9.99999999995449e-06, -0.0005500000000000504, 0.0007199999999999984, -2.0000000000020002e-05, 0.0, -0.0013200000000000434, 0.00014999999999998348, -5.999999999994898e-05, 1.999999999996449e-05, 0.003090000000000037, 0.00018999999999991246, -3.999999999992898e-05, -0.00014999999999998348, -4.0000000000040004e-05, 9.99999999995449e-06, -1.999999999996449e-05, 0.005809999999999982, -0.00017000000000000348, -0.000260000000000038, -0.0007300000000000084, -0.0005899999999999794]
M1_faintest_40 = [-3.999999999998449e-05, 8.999999999997899e-05, 0.004690000000000083, 0.00015999999999999348, -2.0000000000020002e-05, 0.0, 0.0007500000000000284, 0.0, -0.00020000000000003348, 9.99999999995449e-06, -0.0005500000000000504, 0.0007199999999999984, -2.0000000000020002e-05, 0.0, -0.0013200000000000434, 0.00014999999999998348, -5.999999999994898e-05, 1.999999999996449e-05, 0.003090000000000037, 0.00018999999999991246, -3.999999999992898e-05, -0.00014999999999998348, -4.0000000000040004e-05, 9.99999999995449e-06, -1.999999999996449e-05, 0.005809999999999982, -0.00017000000000000348, -0.000260000000000038, -0.0007300000000000084, -0.0005899999999999794, 1.999999999990898e-05, 2.0000000000020002e-05, 0.0, -0.0018099999999999783, 1.0000000000065512e-05, -0.0018400000000000083, 4.0000000000040004e-05, 0.0003500000000000725, -0.0007800000000000029, 0.00017999999999998573]
M1_faintest_50 = [-3.999999999998449e-05, 8.999999999997899e-05, 0.004690000000000083, 0.00015999999999999348, -2.0000000000020002e-05, 0.0, 0.0007500000000000284, 0.0, -0.00020000000000003348, 9.99999999995449e-06, -0.0005500000000000504, 0.0007199999999999984, -2.0000000000020002e-05, 0.0, -0.0013200000000000434, 0.00014999999999998348, -5.999999999994898e-05, 1.999999999996449e-05, 0.003090000000000037, 0.00018999999999991246, -3.999999999992898e-05, -0.00014999999999998348, -4.0000000000040004e-05, 9.99999999995449e-06, -1.999999999996449e-05, 0.005809999999999982, -0.00017000000000000348, -0.000260000000000038, -0.0007300000000000084, -0.0005899999999999794, 1.999999999990898e-05, 2.0000000000020002e-05, 0.0, -0.0018099999999999783, 1.0000000000065512e-05, -0.0018400000000000083, 4.0000000000040004e-05, 0.0003500000000000725, -0.0007800000000000029, 0.00017999999999998573, 0.00047999999999998044, -0.00043000000000004146, 0.0006800000000000139, -4.999999999999449e-05, 0.00034000000000000696, 1.0000000000065512e-05, 6.0000000000060005e-05, -0.00017999999999995797, 1.999999999996449e-05, 2.999999999997449e-05]


M6_loudest_30  = [0.00014999999999998348, 1.999999999996449e-05, 0.00014999999999998348, -4.999999999999449e-05, 0.0007499999999999729, 0.0027399999999999647, -0.0015700000000000713, 0.0005499999999999949, -4.999999999999449e-05, 8.999999999997899e-05, -1.0000000000010001e-05, -0.00018000000000001348, -0.0011099999999999999, 0.003740000000000021, 0.00019999999999997797, 0.0004899999999999904, 0.0017199999999999993, 0.0028200000000000447, 0.0016600000000000226, -0.0010299999999999754, 0.0005199999999999927, 7.999999999999674e-05, 0.0007799999999999474, 0.0006700000000000039, -0.003599999999999992, 0.0009799999999999809, 0.0006299999999999917, 0.0011800000000000144, -0.00032999999999999696, 0.0016599999999999948]
M6_loudest_40  = [0.0012400000000000189, 0.00028000000000000247, -0.0012999999999999678, -0.0034500000000000086, -1.0000000000065512e-05, -0.0005700000000000149, 0.00037000000000003697, -3.0000000000002247e-05, 0.001579999999999998, 0.00021999999999999797, 0.00014999999999998348, 1.999999999996449e-05, 0.00014999999999998348, -4.999999999999449e-05, 0.0007499999999999729, 0.0027399999999999647, -0.0015700000000000713, 0.0005499999999999949, -4.999999999999449e-05, 8.999999999997899e-05, -1.0000000000010001e-05, -0.00018000000000001348, -0.0011099999999999999, 0.003740000000000021, 0.00019999999999997797, 0.0004899999999999904, 0.0017199999999999993, 0.0028200000000000447, 0.0016600000000000226, -0.0010299999999999754, 0.0005199999999999927, 7.999999999999674e-05, 0.0007799999999999474, 0.0006700000000000039, -0.003599999999999992, 0.0009799999999999809, 0.0006299999999999917, 0.0011800000000000144, -0.00032999999999999696, 0.0016599999999999948]
M6_loudest_50  = [-3.0000000000030003e-05, 0.003420000000000034, 9.000000000000674e-05, -0.0012199999999999989, 0.001060000000000061, -0.0011999999999999789, 0.005759999999999987, 0.0, -0.003919999999999979, -0.0016700000000000048, 0.0012400000000000189, 0.00028000000000000247, -0.0012999999999999678, -0.0034500000000000086, -1.0000000000065512e-05, -0.0005700000000000149, 0.00037000000000003697, -3.0000000000002247e-05, 0.001579999999999998, 0.00021999999999999797, 0.00014999999999998348, 1.999999999996449e-05, 0.00014999999999998348, -4.999999999999449e-05, 0.0007499999999999729, 0.0027399999999999647, -0.0015700000000000713, 0.0005499999999999949, -4.999999999999449e-05, 8.999999999997899e-05, -1.0000000000010001e-05, -0.00018000000000001348, -0.0011099999999999999, 0.003740000000000021, 0.00019999999999997797, 0.0004899999999999904, 0.0017199999999999993, 0.0028200000000000447, 0.0016600000000000226, -0.0010299999999999754, 0.0005199999999999927, 7.999999999999674e-05, 0.0007799999999999474, 0.0006700000000000039, -0.003599999999999992, 0.0009799999999999809, 0.0006299999999999917, 0.0011800000000000144, -0.00032999999999999696, 0.0016599999999999948]
M6_faintest_30 = [-6.0000000000004494e-05, 1.0000000000065512e-05, -0.0004899999999999904, -7.999999999996898e-05, 0.0, 0.010019999999999973, -9.99999999995449e-06, -0.00021999999999999797, -7.999999999996898e-05, -6.0000000000004494e-05, -2.0000000000020002e-05, 9.999999999998899e-05, -0.0006499999999999839, 0.00021999999999999797, 2.0000000000020002e-05, -0.0013699999999999823, 0.000260000000000038, -0.0010100000000000664, 2.999999999997449e-05, -0.00012000000000000899, -0.0001300000000000745, -1.0000000000065512e-05, -9.00000000000345e-05, 0.00024999999999997247, -1.0000000000010001e-05, 0.007709999999999995, 1.0000000000065512e-05, -0.0005300000000000304, -7.00000000000145e-05, 9.99999999995449e-06]
M6_faintest_40 = [-6.0000000000004494e-05, 1.0000000000065512e-05, -0.0004899999999999904, -7.999999999996898e-05, 0.0, 0.010019999999999973, -9.99999999995449e-06, -0.00021999999999999797, -7.999999999996898e-05, -6.0000000000004494e-05, -2.0000000000020002e-05, 9.999999999998899e-05, -0.0006499999999999839, 0.00021999999999999797, 2.0000000000020002e-05, -0.0013699999999999823, 0.000260000000000038, -0.0010100000000000664, 2.999999999997449e-05, -0.00012000000000000899, -0.0001300000000000745, -1.0000000000065512e-05, -9.00000000000345e-05, 0.00024999999999997247, -1.0000000000010001e-05, 0.007709999999999995, 1.0000000000065512e-05, -0.0005300000000000304, -7.00000000000145e-05, 9.99999999995449e-06, 7.00000000000145e-05, 1.0000000000010001e-05, -3.999999999992898e-05, 2.0000000000020002e-05, 1.0000000000010001e-05, -3.0000000000085514e-05, -0.0001100000000000545, 9.99999999995449e-06, -1.0000000000010001e-05, 0.00021999999999999797]
M6_faintest_50 = [-6.0000000000004494e-05, 1.0000000000065512e-05, -0.0004899999999999904, -7.999999999996898e-05, 0.0, 0.010019999999999973, -9.99999999995449e-06, -0.00021999999999999797, -7.999999999996898e-05, -6.0000000000004494e-05, -2.0000000000020002e-05, 9.999999999998899e-05, -0.0006499999999999839, 0.00021999999999999797, 2.0000000000020002e-05, -0.0013699999999999823, 0.000260000000000038, -0.0010100000000000664, 2.999999999997449e-05, -0.00012000000000000899, -0.0001300000000000745, -1.0000000000065512e-05, -9.00000000000345e-05, 0.00024999999999997247, -1.0000000000010001e-05, 0.007709999999999995, 1.0000000000065512e-05, -0.0005300000000000304, -7.00000000000145e-05, 9.99999999995449e-06, 7.00000000000145e-05, 1.0000000000010001e-05, -3.999999999992898e-05, 2.0000000000020002e-05, 1.0000000000010001e-05, -3.0000000000085514e-05, -0.0001100000000000545, 9.99999999995449e-06, -1.0000000000010001e-05, 0.00021999999999999797, 0.0, 0.0018600000000000283, -2.0000000000020002e-05, 0.0012300000000000089, -3.999999999998449e-05, 0.0013099999999999778, 8.999999999992347e-05, 0.00015999999999999348, -0.00014999999999998348, 2.0000000000020002e-05]

def Convert(lst): 
    return [ -i for i in lst ] 

# Flags

M1 = 0
M6 = 0

if M1:
    cat_name = 'M1'
else:
    cat_name = 'M6'

fig = plt.figure(figsize=(20,26))
fig.tight_layout(pad=4.0)

plt.subplot(3, 2, 1)
sns.distplot(Convert(M1_loudest_30), kde=False)
plt.grid(alpha=0.3, axis='y')
plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
plt.ylabel("Events",fontsize=16)
plt.title("30 loudest EMRIs", fontsize=20)

plt.subplot(3, 2, 2)
sns.distplot(Convert(M1_faintest_30), kde=False)
plt.grid(alpha=0.3, axis='y')
plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
plt.ylabel("Events",fontsize=16)
plt.title("30 faintest EMRIs", fontsize=20)

plt.subplot(3, 2, 3)
sns.distplot(Convert(M1_loudest_40), kde=False)
plt.grid(alpha=0.3, axis='y')
plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
plt.ylabel("Events",fontsize=16)
plt.title("40 loudest EMRIs", fontsize=20)

plt.subplot(3, 2, 4)
sns.distplot(Convert(M1_faintest_40), kde=False)
plt.grid(alpha=0.3, axis='y')
plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
plt.ylabel("Events",fontsize=16)
plt.title("40 faintest EMRIs", fontsize=20)

plt.subplot(3, 2, 5)
sns.distplot(Convert(M1_loudest_50), kde=False)
plt.grid(alpha=0.3, axis='y')
plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
plt.ylabel("Events",fontsize=16)
plt.title("50 loudest EMRIs", fontsize=20)

plt.subplot(3, 2, 6)
sns.distplot(Convert(M1_faintest_50), kde=False)
plt.grid(alpha=0.3, axis='y')
plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
plt.ylabel("Events",fontsize=16)
plt.title("50 faintest EMRIs", fontsize=20)

fig.suptitle("M1", size = 24)

plt.savefig("M1_redshift_histograms.pdf", bbox_inches='tight')


if M6:
    fig = plt.figure(figsize=(20,26))
    fig.tight_layout(pad=4.0)

    plt.subplot(3, 2, 1)
    sns.distplot(Convert(M6_loudest_30), kde=False)
    plt.grid(alpha=0.3, axis='y')
    plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
    plt.ylabel("Events",fontsize=16)
    plt.title("30 loudest EMRIs", fontsize=20)

    plt.subplot(3, 2, 2)
    sns.distplot(Convert(M6_faintest_30), kde=False)
    plt.grid(alpha=0.3, axis='y')
    plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
    plt.ylabel("Events",fontsize=16)
    plt.title("30 faintest EMRIs", fontsize=20)

    plt.subplot(3, 2, 3)
    sns.distplot(Convert(M6_loudest_40), kde=False)
    plt.grid(alpha=0.3, axis='y')
    plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
    plt.ylabel("Events",fontsize=16)
    plt.title("40 loudest EMRIs", fontsize=20)

    plt.subplot(3, 2, 4)
    sns.distplot(Convert(M6_faintest_40), kde=False)
    plt.grid(alpha=0.3, axis='y')
    plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
    plt.ylabel("Events",fontsize=16)
    plt.title("40 faintest EMRIs", fontsize=20)

    plt.subplot(3, 2, 5)
    sns.distplot(Convert(M6_loudest_50), kde=False)
    plt.grid(alpha=0.3, axis='y')
    plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
    plt.ylabel("Events",fontsize=16)
    plt.title("50 loudest EMRIs", fontsize=20)

    plt.subplot(3, 2, 6)
    sns.distplot(Convert(M6_faintest_50), kde=False)
    plt.grid(alpha=0.3, axis='y')
    plt.xlabel(r"$z_{host} - z_{true}$",fontsize=16)
    plt.ylabel("Events",fontsize=16)
    plt.title("50 faintest EMRIs", fontsize=20)

    fig.suptitle("M6", size = 24)

    plt.savefig("M6_redshift_histograms.pdf", bbox_inches='tight')
